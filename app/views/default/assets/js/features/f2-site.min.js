jQuery.extend(!0,halo,{home:{listStream:function(){},displaySection:function(section){var sectionWrapperSelector='[data-halozone="halo-'+section+'s-wrapper"]',$sectionContent=jQuery(sectionWrapperSelector),$sectionHeader=jQuery(".halo-section-heading",$sectionContent.parent());if(0==$sectionContent.children().length){if($sectionHeader.length&&jQuery(".filter_form",$sectionHeader).length)var form_id=jQuery(".filter_form",$sectionHeader).attr("id"),values=halo.util.getFormValues(form_id);else var values=halo.util.initFormValues();halo.util.setFormValue(values,"usec",section),halo.jax.call("home","DisplaySection",values)}},refreshSection:function(section){var sectionWrapperSelector='[data-halozone="halo-'+section+'s-wrapper"]',$sectionContent=jQuery(sectionWrapperSelector);$sectionContent.children().remove(),halo.home.displaySection(section)},deleteMe:function(){var values=halo.util.getFormValues("popupForm");halo.jax.call("group","DeleteMe",values)}}}),jQuery.extend(!0,halo,{comment:{initCommentInput:function(el){jQuery(el).data("initedCommentInput")||(jQuery(el).autosize().textcomplete([{match:/\B@(\w*)$/,search:function(term,callback){jQuery.post(halo_jax_targetUrl,{com:"autocomplete",func:"searchUsers",term:term,csrf_token:jQuery('meta[name="csrf_token"]').attr("content")},function(){},"json").done(function(resp){callback(resp)}).fail(function(){callback([])})},template:function(ele){return'<img src="'+ele.image+'"></img> '+ele.name},index:1,replace:function(ele){return"@"+ele.name+" "}},{match:/\B:([\-*\w]*)$/,search:function(term,callback){callback(jQuery.map(emojify.emojiNames,function(emoji){return 0===emoji.indexOf(term)||0===emoji.indexOf(":"+term)?emoji:null}))},template:function(value){return emojify.replace(":"+value+":")},replace:function(value){return":"+value+": "},index:1,maxCount:8}]).overlay([{match:/\B[@|#]\w+/g,css:{"background-color":"#d8dfea"}}]).on("keydown",function(e){var code=e.keyCode||e.which;return 13!=code||e.shiftKey?void 0:""==jQuery(this).val()?!1:(halo.comment.submit(jQuery(this).closest("form")),halo.share.resetShareBlock(jQuery(this)),!1)}).focus(),jQuery(document).trigger("lazyloading.halo"),jQuery(el).data("initedCommentInput",!0),halo.share.bindEvent(jQuery(el),".textcomplete-wrapper"))},init:function(scope){jQuery(".halo-comment-box",scope).each(function(){jQuery(this).one("click",function(){halo.comment.initCommentInput(this)})}),jQuery(".halo-comment-actor-switcher .selectpicker",scope).selectpicker().on("change",function(){var actorParts=jQuery(this).val().split(".");if(2==actorParts.length){var displayContext=halo.util.closest(jQuery(this),'[name="comment_display_context"]');displayContext&&displayContext.length&&displayContext.val(actorParts[0]);var displayId=halo.util.closest(jQuery(this),'[name="comment_display_id"]');displayId&&displayId.length&&displayId.val(actorParts[1])}})},submit:function(el){var values=halo.util.getFormValues(jQuery(el).attr("id")),$switcher=jQuery(el).closest(".haloj-content-block").find(".halo-comment-actor-switcher");if($switcher.length){var display_context=$switcher.find('[name="comment_display_context"]').val(),display_id=$switcher.find('[name="comment_display_id"]').val();display_context&&display_id&&(halo.util.setFormValue(values,"display_context",display_context),halo.util.setFormValue(values,"display_id",display_id))}return halo.util.canSubmit(el)?(halo.util.resetFormValues(jQuery(el).attr("id")),jQuery(".halo-uploader-holder",el).empty(),void halo.jax.call("comment","Submit",values,halo.jax.successCb(function(){halo.comment.updateCounter(el,1)}))):!1},viewall:function(id,context){halo.jax.call("comment","ViewAll",id,context)},"delete":function(id){var wrapper=jQuery('[data-comment-id="'+id+'"]').parent();halo.jax.call("comment","Delete",id,halo.jax.successCb(function(){halo.comment.updateCounter(wrapper,-1)}))},updateCounter:function(wrapper,delta){if(wrapper.length&&($commentCount=halo.util.closest(wrapper,".comment-count"),$commentCount)){var count=parseInt($commentCount.html());$commentCount.html(count+delta)}},edit:function(id){halo.jax.call("comment","ShowEdit",id)},editFocus:function(id){var input=jQuery('textarea[name="comment_'+id+'"]');input.closest(".halo-stream-comment-item").removeClass("hidden").parent().removeClass("hidden"),input.focus().click()},showEdit:function(id){var el=jQuery('[data-raw-input="message_edit_'+id+'"]');el.length&&(jQuery("#comment_"+id).hide(),jQuery("#comment_edit_"+id).show(),el.height(60),halo.comment.initCommentInput(el),el.on("keydown",function(e){var code=e.keyCode||e.which;return 27==code?(halo.comment.doneEdit(id),!1):void 0}),jQuery("#comment_edit_"+id+" textarea").focus().click())},doneEdit:function(id){var el=jQuery('[data-raw-input="message_edit_'+id+'"]');el.length&&(jQuery("#comment_edit_"+id).remove(),jQuery("#comment_"+id).show())},removePhoto:function(ele){var $wrapper=jQuery(ele).closest(".halo-comment-body").find(".halo-comment-attachment");$wrapper.length&&($wrapper.find("a").remove(),jQuery(ele).remove());var commentId=$wrapper.closest("[data-comment-id]").attr("data-comment-id");return commentId&&halo.jax.call("comment","RemovePhoto",commentId),!1}}}),!function($){jQuery(document).on("uploader.uploadSuccess",".comment_form .halo-uploader-holder",function(e,response){jQuery(this).append('<input type="hidden" name="photo_id" value="'+response.id+'"/>')})}(window.jQuery),jQuery.extend(!0,halo,{share:{windows:{},blankWindow:function(){var winId=halo.util.uniqID();return halo.share.windows[winId]=window.open("","","menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600"),winId},startShare:function(url,winId){if("undefined"!=typeof halo.share.windows[winId])var win=halo.share.windows[winId],id=setInterval(function(){try{win.location.href.indexOf("#halo_redirect_close")>=0&&(clearInterval(id),win.close())}catch(e){}},3e3)},getShareUrl:function(url,type){if("google"==type)return"https://plus.google.com/share?url="+encodeURIComponent(url);if("facebook"==type){var app_id="app_id="+halo.share.getFacebookAppId(),link="link="+encodeURIComponent(url),redirect_uri="redirect_uri="+encodeURIComponent(url);return"https://www.facebook.com/dialog/feed?"+app_id+"&"+link+"&"+redirect_uri+"&display=popup"}},email:function(postId){var values=halo.util.getFormValues("popupForm");jQuery.isEmptyObject(values.form)&&(values=halo.util.initFormValues(),halo.util.setFormValue(values,"post_id",postId)),halo.jax.call("post","ShareByEmail",values)},google:function(url){"undefined"==typeof url&&(url=location.href+"#halo_redirect_close"),jQuery(document).trigger("halo_share",["google"]);var shareUrl=halo.share.getShareUrl(url,"google");win=window.open(shareUrl,"","menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600");var id=setInterval(function(){try{win.location.href.indexOf("#halo_redirect_close")>=0&&(clearInterval(id),win.close())}catch(e){}},3e3)},getGoogleCount:function(url,target){HALOModernizr.load([{load:["https://apis.google.com/js/client:plusone.js"],complete:function(){var params={nolog:!0,id:url,source:"widget",userId:"@viewer",groupId:"@self"};setTimeout(function(){var apiKey=jQuery("#halo_ggApiKey").attr("data-gg");apiKey&&(gapi.client.setApiKey(apiKey),gapi.client.rpcRequest("pos.plusones.get","v1",params).execute(function(resp){"undefined"!=typeof resp.message&&resp.message.indexOf("Access Not Configured")>=0?(halo.log("error",resp),jQuery(target).text("")):"undefined"!=typeof resp.result&&"undefined"!=typeof resp.result.metadata&&jQuery(target).text(resp.result.metadata.globalCounts.count)}))},100)}}])},getFacebookAppId:function(){var e=jQuery("#halo_fbApiKey");return e.length?e.attr("data-fb"):""},facebook:function(url){"undefined"==typeof url&&(url=location.href+"#halo_redirect_close"),jQuery(document).trigger("halo_share",["facebook"]);var shareUrl=halo.share.getShareUrl(url,"facebook");win=window.open(shareUrl,"","menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600");var id=setInterval(function(){try{win.location.href.indexOf("#halo_redirect_close")>=0&&(clearInterval(id),win.close())}catch(e){}},3e3)},getFacebookCount:function(url,target){var fbCount=0;jQuery.getJSON("http://graph.facebook.com/?ids="+url,function(data){"undefined"!=typeof data[url]&&"undefined"!=typeof data[url].shares&&(fbCount=data[url].shares),jQuery(target).text(fbCount)})},init:function(scope){jQuery(".halo-share-toggle",scope).each(function(){function openShare($container){$container.removeClass("hidden"),$container.trigger("shown.halo.share"),jQuery(".halo-share-item-wrapper").each(function(){var counterFn=jQuery(this).attr("data-counter"),url=jQuery(this).attr("data-url"),target=jQuery("#count_"+jQuery(this).attr("data-name"));"undefined"==typeof url&&(url=location.href),"undefined"!=typeof counterFn&&"function"==typeof halo.share[counterFn]&&halo.share[counterFn].apply(this,[url,target])})}function closeShare($container){$container.addClass("hidden"),$container.trigger("hide.halo.share")}function toggleShare($container){$container.hasClass("hidden")?openShare($container):closeShare($container)}$e=jQuery(this),$shareContainer=$e.siblings(".halo-share-items"),$e.on("click",function(){toggleShare($shareContainer)}),$e.mouseenter(function(){openShare($shareContainer)});var clickEveryWhere=function(e){jQuery(e.target).hasClass("halo-share-toggle")||0!==jQuery(e.target).closest(".halo-share-items").length||closeShare($shareContainer)};$shareContainer.on("shown.halo.share",function(){jQuery(document).on("click",clickEveryWhere)}),$shareContainer.on("hide.halo.share",function(){jQuery(document).off("click",clickEveryWhere)})})},addShareLinkBlock:function(ele,url){var uid=halo.util.uniqID(),halozone="share.link.block."+uid,template='<div class="halo-share-link-block" data-halozone="'+halozone+'"><div class="halo-loading"></div></div>',$target=jQuery(ele),$shareBlock=jQuery(".halo-share-link-block",$target.parent());$shareBlock.length?$shareBlock.replaceWith(jQuery(template)):jQuery(template).insertAfter($target),halo.jax.call("system","AddShareLinkBlock",url,halozone);var $input=jQuery(".halo-share-link-input",$target);$input.length&&$input.trigger("addLink",url)},removeShareLinkBlock:function(ele){var $ele=jQuery(ele),$block=$ele.closest(".halo-share-link-block");$block.length&&($block.empty(),$block.append('<input name="nopreview" type="hidden" value="1"/>'))},removeLinkPreview:function(ele,context,id){var $ele=jQuery(ele),$preview=$ele.closest(".halo-url-preview");$preview.remove(),halo.jax.call("system","RemoveLinkPreview",context,id)},resetShareBlock:function(input){var $this=jQuery(input),selector=$this.data("gbShareParent");if(selector){var $parent=$this.closest(selector);if($parent.length){var $block=jQuery(".halo-share-link-block",$parent.parent());$block.length&&$block.remove()}}},parseShareLink:function(ele){function getUrl(urls,$input){var ignoreUrlString=$input.data("ignoreUrls"),ignoreUrls=[];if(ignoreUrlString&&ignoreUrlString.length&&(ignoreUrls=ignoreUrlString.split(",")),urls.length)for(var url=urls.shift();url;){if(ignoreUrls.indexOf(url)<0)return url;url=urls.shift()}return null}var $ele=jQuery(ele),$shareBlock=jQuery(".halo-share-link-block.halo-link-preview",$ele.parent());if(!$shareBlock.length){var $input=jQuery("textarea",$ele),text=$input.val(),urls=halo.util.parseUrls(text),url=null;urls&&urls.length&&(url=getUrl(urls,$input),url&&(url=halo.util.parseWWWUrl(url),halo.share.addShareLinkBlock($ele,url)))}},bindEvent:function($ele,selector){$ele.addClass("halo-share-link-input"),$ele.data("gbShareParent",selector),$ele.on("keyup",halo.util.throttle(function(){var $this=jQuery(this),selector=$this.data("gbShareParent");if(selector){var $parent=$this.closest(selector);$parent.length&&halo.share.parseShareLink($parent)}},700)).on("addLink",function(event,url){var $this=jQuery(this),ignoreUrls=$this.data("ignoreUrls");ignoreUrls=halo.util.addValToArrText(ignoreUrls,url),$this.data("ignoreUrls",ignoreUrls)})}}}),jQuery.extend(!0,halo,{status:{taggedUsers:!1,incomplete:!1,submit:function(){if(halo.util.canSubmit()){var activeTab=jQuery(".halo-share-box .tab-pane.active"),attachmentForm=jQuery("form",activeTab),statusForm=jQuery("#status_form"),infoForm=jQuery("#status_form_info");if(halo.status.incomplete=!1,statusForm.length&&statusForm.valid()&&attachmentForm.length&&attachmentForm.valid()&&infoForm.length&&infoForm.valid()){var values=halo.util.getFormValues("status_form");values.form=jQuery.extend({},values.form,halo.util.getFormValues(infoForm.attr("id")).form,halo.util.getFormValues(attachmentForm.attr("id")).form),halo.jax.call("status","SubmitStatus",values)}}},reset:function(){var $statusForm=jQuery(".status_form_wrapper");$statusForm.length&&halo.jax.call("status","ResetStatusForm",$statusForm.attr("data-context"),$statusForm.attr("data-target"))},"delete":function(id){halo.popup.confirmDialog(__halotext("Delete Activity Confirm"),__halotext("Are you sure you want to delete this activity?"),"halo.jax.call('status', 'DeleteStatus', '"+id+"')")},editPost:function(id){halo.jax.call("status","EditPostForm",id)},cancelEditPost:function(id){halo.jax.call("status","CancelEditPost",id)},doneEditPost:function(id){var values=halo.util.getFormValues("edit_post_form_"+id);halo.jax.call("status","DoneEditPost",id,values)},deleteCallBack:function(id){halo.popup.close(),jQuery('[data-actid="'+id+'"]').remove()},changePrivacy:function(id){var input=jQuery('[name="act_privacy_'+id+'"]');halo.jax.call("status","ChangePrivacy",id,input.val())},initLocation:function(scope){function doneEditLocation(datum){setShareLocation(datum),jQuery(".halo-share-info-location").addClass("hidden")}function setShareLocation(datum){datum.name.length?jQuery(".halo-share-info-loc-icon").attr("title",datum.name):jQuery(".halo-share-info-loc-icon").attr("title",__halotext("Location")),jQuery(".halo-share-info-loc-icon .halo-loc-text").text(" "+datum.name),jQuery('[name="share_location_name"]').val(datum.name),jQuery('[name="share_location_lat"]').val(datum.lat),jQuery('[name="share_location_lng"]').val(datum.lng),jQuery("[data-halo-location-share]").val(datum.name)}var input=jQuery(".halo-share-info-location .share_info_input",scope);input.on("location.change.halo",function(event,datum){doneEditLocation(datum)}),input.on("change",function(){var $this=jQuery(this);$this.val().length||input.trigger("location.change.halo",[{name:"",lat:"",lng:""}])}),jQuery(".halo-share-info-location",scope).on("shown.display.halo",function(){halo.location.hasShareLocation()?(jQuery("[data-halo-location-share]").val(jQuery('[name="share_location_name"]').val()),input.focus()):halo.location.autodetect({},function(){var currentPos=halo.location.getCurrentPosition();if(currentPos){var datum={lat:currentPos.lat(),lng:currentPos.lng(),name:halo.location.getCurrentAddress()};setShareLocation(datum),input.focus()}})})},initTaggedUser:function(scope){function suggestionTemplate(context){return Hogan.compile('<p class="name"><image class="halo-suggestion-img" src={{image}}>{{name}}</p>').render(context)}function doneTagging(){jQuery('[name="share_tagged_list"]').val()}function onTaggingUser(e,datum){tagApi.tagsManager("pushTag",datum.name,!1,datum.id),jQuery('[name="share_tagged_list"]').val(tagApi.data("tlid").join(","))}var input=jQuery(".halo-share-info-taggeduser .share_info_input",scope);jQuery(".halo-share-info-taggeduser",scope).on("shown.display.halo",function(){input.focus()});var tagApi=input.tagsManager({onlyTagList:!0,tagClass:"tm-tag-info",preventSubmitOnEnter:!0,externalTagId:!0,tagsContainer:jQuery(".halo-share-info-label")}).on("tm:popped",function(tag,tagId){jQuery('[name="share_tagged_list"]').val(tagApi.data("tlid").join(","))}).on("tm:spliced",function(tag,tagId){jQuery('[name="share_tagged_list"]').val(tagApi.data("tlid").join(","))}),users=new Bloodhound({datumTokenizer:Bloodhound.tokenizers.obj.whitespace("name"),queryTokenizer:Bloodhound.tokenizers.whitespace,remote:{url:halo.util.mergeUrlParams(halo_jax_targetUrl,{term:"%QUERY",com:"autocomplete",func:"searchUsers",csrf_token:jQuery('meta[name="csrf_token"]').attr("content")}),beforeSend:function(jqXhr,settings){return settings.data=JSON.stringify({com:"autocomplete",func:"searchUsers",csrf_token:jQuery('meta[name="csrf_token"]').attr("content")}),!0}}});users.initialize(),input.typeahead({highlight:!0},{name:"taggedusers",displayKey:"name",source:users.ttAdapter(),templates:{empty:'<div class="halo-location-not-found text-center">'+__halotext("No User Matched")+"</div>",suggestion:suggestionTemplate},engine:Hogan}).on("typeahead:selected",onTaggingUser).on("typeahead:autocompleted",onTaggingUser).on("focusout",function(){doneTagging()}).on("keydown",function(e){var code=e.keyCode||e.which;return code!=halo.keycode.ENTER||e.shiftKey||(e.preventDefault(),""!=jQuery.trim(jQuery(this).val()))?void 0:(doneTagging(),!1)})},init:function(scope){jQuery(".halo-status-box",scope).each(function(){jQuery(this).autosize({}).textcomplete([{match:/\B@(\w*)$/,search:function(term,callback){jQuery.post(halo_jax_targetUrl,{com:"autocomplete",func:"searchUsers",term:term,csrf_token:jQuery('meta[name="csrf_token"]').attr("content")},function(){},"json").done(function(resp){callback(resp)}).fail(function(){callback([])})},template:function(ele){return'<img src="'+ele.image+'"></img> '+ele.name},index:1,replace:function(ele){return"@"+ele.name+" "}},{match:/\B:([\-*\w]*)$/,search:function(term,callback){callback(jQuery.map(emojify.emojiNames,function(emoji){return 0===emoji.indexOf(term)||0===emoji.indexOf(":"+term)?emoji:null}))},template:function(value){return emojify.replace(":"+value+":")},replace:function(value){return":"+value+": "},index:1,maxCount:8}]).overlay([{match:/\B[@|#]\w+/g,css:{"background-color":"#d8dfea"}}]),halo.share.bindEvent(jQuery(this),".textcomplete-wrapper")}),halo.status.initLocation(scope),halo.status.initTaggedUser(scope),jQuery(".halo-status-box",scope).one("focus",function(e){jQuery(".halo-status-function",scope).removeClass("hidden"),jQuery(".halo-status-heading",scope).removeClass("hidden"),jQuery(".halo-status-attachment",scope).removeClass("hidden"),jQuery(".md-header",scope).removeClass("hidden")}),jQuery('[name="video_path"]',scope).on("change",function(e){var url=jQuery(this).val(),width=jQuery(".halo-sharebox-embeded-player").width(),height=Math.floor(3*parseInt(width)/4);jQuery(".halo-sharebox-embeded-player").css("height",height+"px"),jQuery(".halo-sharebox-embeded-player").html(halo.template.getJaxLoading(2)),halo.jax.call("video","FetchVideo",url,width,height)})}}}),jQuery.extend(!0,halo,{review:{submit:function(context,target_id){var values=halo.util.getFormValues("popupForm");halo.jax.call("review","Submit",context,target_id,values)},edit:function(reviewId){var values=halo.util.getFormValues("popupForm");halo.jax.call("review","Edit",reviewId,values)},approve:function(reviewId){var values=halo.util.getFormValues("popupForm");halo.jax.call("review","Approve",reviewId,values)},deleteMe:function(reviewId){var values=halo.util.getFormValues("popupForm");halo.jax.call("review","Delete",reviewId,values)},viewall:function(targetId,context){halo.jax.call("review","ViewAll",targetId,context)},removeReviewBtn:function(){jQuery(".halo-review-btn").remove()},haveReviews:function(count){count?jQuery(".halo-no-reviews").addClass("hidden"):jQuery(".halo-no-reviews").removeClass("hidden")}}}),jQuery.extend(!0,halo,{browse:{loadScriptCb:null,$preferSection:null,currentLocation:null,inited:!1,isBrowsing:!1,ready:!1,loadCurrentLocation:function(){halo.location.autodetect({},function(){var currentPos=halo.location.getCurrentPosition();currentPos&&(halo.browse.setCurrentLocation({lat:currentPos.lat(),lng:currentPos.lng(),name:halo.location.getCurrentAddress()}),halo.browse.reloadResults())})},setCurrentLocation:function(locData){jQuery("input.halo-field-location-lat").val(locData.lat),jQuery("input.halo-field-location-lng").val(locData.lng),jQuery("input.halo-field-location-name").val(locData.name)},search:function(){jQuery(".navbar-form").submit()},mobileSearch:function(){halo.popup.setFormTitle(__halotext("Search"));var content=jQuery(".halo-popup-navbar-search");content.length&&halo.popup.setFormContent(content.html()),halo.popup.showForm("fullscreen"),halo.popup.addFormAction({name:__halotext("Search"),onclick:"halo.browse.search()",href:"javascript:void(0);"}),halo.popup.addFormActionCancel()},showMobileFilters:function(selector,title){var form=jQuery(selector);if(form.length){var clonedForm=form.clone(!0,!0);clonedForm.addClass("cloned-form"),halo.popup.setFormTitle(title),jQuery(".hidden-xs",clonedForm).each(function(){jQuery(this).removeClass("hidden-xs"),jQuery(this).addClass("cloned-hidden-xs")}),halo.popup.showForm("fullscreen"),halo.popup.addFormAction({name:__halotext("OK"),onclick:"halo.browse.updateMobileForm('"+selector+"')",href:"javascript:void(0);"}),halo.popup.addFormActionCancel(),clonedForm.appendTo(jQuery(".halo-popup-content")),jQuery(".halo-slider-input").slider()}},updateMobileForm:function(selector){var form=jQuery(selector+":not(.cloned-form)"),clonedForm=jQuery(".cloned-form");form.length&&clonedForm.length&&(jQuery(".cloned-hidden-xs",clonedForm).each(function(){jQuery(this).addClass("hidden-xs"),jQuery(this).removeClass("cloned-hidden-xs")}),clonedForm.removeClass("cloned-form"),form.replaceWith(clonedForm)),halo.popup.close(),halo.browse.reloadResults()},reloadResults:function(){if(!halo.popup.isOpen())if(halo.browse.isBrowsing){var filters=halo.util.getFormValues("filter_form");filters=filters.form;var param={};for(index=0;index<filters.length;++index)param[filters[index][0]]=filters[index][1];var filters=halo.util.getFormParams("filter_form");halo.browse.displaySection(),halo.util.setUrlParam(filters)}else jQuery(".halo_browse_form").length?jQuery(".halo_browse_form").submit():jQuery(".halo-menu-search").length&&jQuery(".halo-menu-search").submit()},displaySection:function(section){if(jQuery(".filter_form").length)var form_id=jQuery(".filter_form").attr("id"),values=halo.util.getFormValues(form_id);else var values=halo.util.initFormValues();halo.util.setFormValue(values,"usec",section),halo.jax.call("browse","DisplaySection",values)},init:function(scope){halo.browse.inited||(halo.browse.$preferSection=jQuery(".halo-browser-selected-post"),jQuery(".halo-browse-listing").length&&(halo.browse.isBrowsing=!0),halo.browse.inited=!0,halo.location.loadScript(function(){halo.browse.ready=!0;var $placeInput=jQuery(".halo-field-location-name");$placeInput.length&&$placeInput.attr("id")&&halo.location.loadScript(function(){var input=document.getElementById($placeInput.attr("id")),searchBox=new google.maps.places.SearchBox(input);google.maps.event.addListener(searchBox,"places_changed",function(){var places=searchBox.getPlaces();if(places.length){var loc=places[0].geometry.location;halo.browse.setCurrentLocation({lat:loc.lat(),lng:loc.lng(),name:places[0].name}),halo.browse.reloadResults()}})}),jQuery(".halo-slider-input").on("slideStop",function(){halo.browse.reloadResults()}),jQuery(".halo-sort-btn").on("click",function(){function setDir($ele,dir){jQuery("i",$ele).removeClass(iconPrefix+"desc"),jQuery("i",$ele).removeClass(iconPrefix+"asc"),jQuery("i",$ele).addClass(iconPrefix+dir)}var $this=jQuery(this),iconPrefix="fa-sort-amount-",dir=jQuery("."+iconPrefix+"asc",$this).length?"asc":"desc",sort=$this.attr("data-value");$this.hasClass("active")?("desc"==dir?dir="asc":(sort="",$this.removeClass("active")),setDir($this,dir)):(dir="desc",jQuery(".halo-sort-btn").each(function(){jQuery(this).removeClass("active"),setDir(jQuery(this),"desc")}),$this.addClass("active")),$this.siblings(".halo-sort-input").val(sort),$this.siblings(".halo-dir-input").val(dir),halo.browse.reloadResults()}),jQuery(".halo-owner-btn").on("click",function(){var $this=jQuery(this),ownerId="";$this.toggleClass("active"),$this.hasClass("active")&&(ownerId=$this.attr("data-value")),$this.siblings(".halo-owner-input").val(ownerId),halo.browse.reloadResults()})}))},_selectPostCard:function(_postCard){halo.browse.$preferSection.removeClass("hidden"),halo.browse.$preferSection.append(jQuery(_postCard).parent())},canRefresh:function(){return!halo.browse.lockRefresh.length||halo.util.isMobile()&&!jQuery(".halo-mapcontent-toggle-btn").hasClass("halo-show")},updateResultCounter:function(msg){jQuery(".halo-search-result-stats p").html(msg)}}});